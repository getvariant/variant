#!/bin/bash

running_pid () {
  ps -ef | grep java | grep 'com.variant.server.boot.VariantServer' | awk '{print $2}'
}

# Class loader expects variant root to be the current dir.
cd $(dirname $0)/..

case "$1" in
start)
   shift
   bin/variant-ctl $@
   ;;

stop)
   # Sending the process the interrupt signal appears to be the prescribed way to shutdown the server.
   pid=$(running_pid)
   if [ -n "$pid" ]; then
      kill -2 $pid
      echo "Variant Server stopped"
   fi

   ;;
status)
   pid=$(running_pid)
   if [ -n "$pid" ] ; then 
      echo "Variant Server running as PID $pid" 
   else
      echo "Variant Server not running"
   fi  
   ;;
*)
        echo "Usage: variant.sh {start|stop|status}"
        exit 1
esac
